PYVENVS=~/.venvs
PYVENVS_ALIASRC=$PYVENVS/.aliasrc

pyvenv () {
  local name
  name=$1

  [ -d $PYVENVS/$name ] && echo "Virtual environment '$name' already exists at: $PYVENVS/$name" && return 1

  mkdir -p $PYVENVS && \
  python3 -m venv $PYVENVS/$name && \
  echo -e "alias activate-$name='source $PYVENVS/$name/bin/activate'" >> $PYVENVS_ALIASRC

  # echo "PS1=\"\[\033[1;30m\]$name\[\033[m\] \[\033[1;37m\]❯\[\033[m\]\$PS1_BASE\"" >> $PYVENVS/$name/bin/activate
  # echo "export PS1" >> $PYVENVS/$name/bin/activate
}

pyvenv-ls () {
  ls -1 $PYVENVS
}

pyvenv-tear () {
  local name
  name=$1

  [ ! -d $PYVENVS/$name ] && echo "Error: virtual environment '$name' not found at: $PYVENVS/$name" && return 1
  rm -rf $PYVENVS/$name

  _alias=$(cat $PYVENVS_ALIASRC | grep "activate-$name")
  [[ -z $_alias ]] && echo "Warning: no alias found for: $name at: $PYVENVS_ALIASRC" || \
          sed -i "/^alias activate-$name/d" $PYVENVS_ALIASRC
}

# Above populates below sourced script
[ -f $PYVENVS_ALIASRC ] && source $PYVENVS_ALIASRC
