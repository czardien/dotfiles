# Relevant resources for common issues:
# https://unix.stackexchange.com/questions/105958/terminal-prompt-not-wrapping-correctly
# https://unix.stackexchange.com/questions/11156/re-escape-brackets-in-ps1
# https://stackoverflow.com/questions/6592077/bash-prompt-and-echoing-colors-inside-a-function

function __git_ps1 () {
	ref=$(git symbolic-ref HEAD 2> /dev/null) || return 0
	PS_GIT="${ref#refs/heads/}"
	echo -e " \[\033[1;34m\]Ґ $PS_GIT\[\033[m\] \[\033[1;37m\]❯\[\033[m\]"
}

function __suffix_ps1 () {
	[[ "$(pwd)" == "$HOME" ]] && echo -e  "\[\033[1;37m\] \[\033[m\]" || echo -e "\n \[\033[1;37m\]↳\[\033[m\] "
}

function __pyvenv_ps1 () {
	[[ -z $VIRTUAL_ENV ]] && echo -e " " || echo -e " \[\033[1;30m\]$(basename $VIRTUAL_ENV)\[\033[m\] \[\033[1;37m\]❯\[\033[m\] "
}

set_bash_prompt(){
    PS1="$(__pyvenv_ps1)\[\033[1;36m\]\w\[\033[m\] \[\033[1;37m\]❯\[\033[m\]$(__git_ps1)$(__suffix_ps1)"
}

PROMPT_COMMAND=set_bash_prompt
